name: Fetch Data

on:
  push:
    branches:
      - main  # Trigger the workflow on any push to the main branch
  workflow_dispatch:  # Allow manual triggering of the workflow

jobs:
  fetch-data:
    runs-on: ubuntu-latest  # Or your desired runner OS
    steps:
      - name: Checkout code
        uses: actions/checkout@v3  # Checks out your code

      - name: Install jq (optional for processing JSON data)
        run: |
          sudo apt update
          sudo apt install jq  # Tool for processing JSON data (optional)

      - name: Fetch data from Google Sheet
        run: |
          curl -X GET \
          https://sheets.googleapis.com/v4/spreadsheets/19r8IWr7xwpP2NhtQzs_5m00FaKbGcOfN95uiyr55zH4/values/A:A?key=AIzaSyBDu3it44u_xfEoFHbNOuWrK7f1h9Bhdig \        
          -o data.json

      - name: Update app-ads.txt
        run: |  # Update your app-ads.txt file with fetched data
          cp data.json app-ads.txt  
        
      # - name: Process data (optional)
      #   run: |  # Example: Extract specific data using jq (optional)
      #     DATA=$(echo ${{ steps.fetch-data.outputs.body }} | jq '.[0]')  # Assuming first element
      #     echo "Extracted data: $DATA"

      # - name: Update app-ads.txt
      #   run: |  # Update your app-ads.txt file with fetched data
      #     echo "$DATA" >> app-ads.txt  # Append data to app-ads.txt (adjust based on your needs)

      # - name: Add and commit changes
      #   run: |
      #     git config user.name 'GitHub Actions'
      #     git config user.email 'actions@github.com'
      #     git add app-ads.txt
      #     git commit -m "Update app-ads.txt with fetched data (automated)"
      #     git push origin main  # Push changes to main branch (adjust branch name if needed)